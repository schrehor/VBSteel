@page "/account"
@inject AuthenticationProvider AuthenticationProvider
@inject AuthorizedHttpClient AuthorizedHttpClient
@using VBSteel.Shared
@using VBSteel.Client.Pages.Components

<div class="stretch-content-fullscreen">
	<h3>Môj účet</h3>
	@if (!_isUserLoggedIn)
	{
		<p>Please log in to view this page.</p>
	}
	else
	{
		<MessageView UserRole="@_userRole" />
	}
</div>

@code {
    private bool _isUserLoggedIn;
    private UserRole _userRole;

	protected override async Task OnInitializedAsync()
	{
		var authState = await AuthenticationProvider.GetAuthenticationStateAsync();
		var user = authState.User;
		if (user.Identity != null)
			_isUserLoggedIn = user.Identity.IsAuthenticated;

		if (_isUserLoggedIn)
			_userRole = AuthenticationProvider.DetermineUserRole();

	}
}

