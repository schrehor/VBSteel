@page "/contact"
@inject HttpClient HttpClient
@using VBSteel.Shared
@using Microsoft.AspNetCore.Components.Forms

<div class="container pic-back content">
	<div class="row">
		<div class="col-md-6 py-5">
			<EditForm Model="@contactForm" OnValidSubmit="@HandleSubmit">
				<DataAnnotationsValidator/>
				<div class="mb-3">
					<label for="emailInput" class="form-label">Email:</label>
					<input type="email" class="form-control" id="emailInput" @bind="contactForm.Email"/>
					<ValidationMessage For="@(() => contactForm.Email)"/>
				</div>
				<div class="mb-3">
					<label for="textInput" class="form-label">Správa:</label>
					<textarea class="form-control" id="textInput" @bind="contactForm.Message"></textarea>
					<ValidationMessage For="@(() => contactForm.Message)"/>
				</div>
				<button type="submit" class="btn btn-primary">Odoslať</button>
			</EditForm>
		</div>
		<div class="col-md-6">
			<div class="text-center py-5 bold">
				<h1>Kde nás nájdete</h1>
				<p>Poloha: Univerzitná 8215, 010 26 Žilina</p>
				<p>telefón: +4219123456789</p>
				<p>mail: info@vbsteel.sk</p>
				<p>Otváracie hodiny:</p>
				Pondelok: 7:00–15:00<br>
				Utorok: 7:00–15:00<br>
				Streda: 7:00–15:00<br>
				Štvrtok: 7:00–15:00<br>
				Piatok: 7:00–15:00<br>
				Sobota: zatvorené<br>
				Nedeľa: zatvorené
			</div>
		</div>
	</div>
</div>

@code {
	//todo:Prerobit podla novej DB architektury
	private Form contactForm = new();

	private async Task HandleSubmit(EditContext editContext)
	{
		var response = await HttpClient.PostAsJsonAsync("https://localhost:7280/api/Form/submitForm", contactForm);

		if (response.IsSuccessStatusCode)
		{
			var result = await response.Content.ReadAsStringAsync();
			Console.WriteLine("Form submitted successfully: " + result);
		}
		else
		{
			Console.WriteLine("Failed to submit form.");
		}
	}
}
